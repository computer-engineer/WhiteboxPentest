# Whitebox Pentest (Based on AWAE/OSWE)
This repo is based on the offensive security AWAE syllabus and is designed to act as a cheatsheet for the OSWE exam and whitebox source code reviews in general.

## Free Source Code Review Courses
- https://owasp.org/SecureCodingDojo/codereview101/
- https://pentesterlab.com/exercises/codereview/course

## Source Code Review Methdologies
S. No| Approach|
|     :---:      |     :---:      |
|1|String matching/Grep for bugs |
|2|Following user input|
|3|Reading source code randomly|
|4|Read all the code|
|5|Check one functionality at a time (login, password reset...)|

Reference: https://pentesterlab.com/exercises/codereview/course

## Dangerous Functions

References: 
- Nodejs: https://github.com/rinku191/OSWE-prepration/wiki/Nodejs-Dangerous-function
- C#: https://github.com/rinku191/OSWE-prepration/wiki/C%23-Dangerous-Function
- PHP: https://github.com/rinku191/OSWE-prepration/wiki/PHP-Dangerous-function
- Java: https://github.com/Cryin/JavaID

## Enable Database Logging

<details><summary>MySQL/MariaDB</summary>
<p>
Modify the following values on my.cnf file(Typically located at /etc/mysql/my.cnf)</br>

    ```
     [mysqld]
     general_log_file = /var/log/mysql/mariadb.log
     general_log = 1
    ```
*In case of mariadb the settings will be present under `[mariadb]`</br>
Restart the mysql service for the change to take affect</br>
You can read the log file in realtime using `sudo tail -f /var/log/mysql/mysql.log`
</p>
</details>

- Postgres: https://tableplus.com/blog/2018/10/how-to-show-queries-log-in-postgresql.html

## Enable Remote Debugging
- Java: https://stackify.com/java-remote-debugging/
- Java: https://stackoverflow.com/questions/975271/remote-debugging-a-java-application
- Java, PHP, NodeJs: [Requires access to offsec forums] https://forums.offensive-security.com/showthread.php?37965-Visual-Studio-Code-debugging&p=172805

## OSWE: Possible vulnerabilities that might show up in exam based on the syllabus
|Auth Bypass	| RCE|
|     :---:      |     :---:      |
|SQL Injection - [Payloads](https://portswigger.net/web-security/sql-injection/cheat-sheet)| Deserialization|
|Persistent Cross-Site Scripting	| Bypassing File Upload Restrictions|
IDOR	|SQL Injection RCE (Postgres UDF or Mysql copy to function)|
Weak random token generator	| XXE - [Payloads](https://github.com/payloadbox/xxe-injection-payload-list)|
|Type Juggling	| XML Injection|
|Cross-Site Request Forgery	- [Payloads](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/CSRF%20Injection/README.md#html-get---no-user-interaction)| SSTI - [Payloads](https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection)|
| - |	Prototype Pollution|
| - |	JavaScript Injection|
| - |	OS Command Injection|

## Vulnerable Code Examples
| Language - PHP|
|     :---:      |
|[XSS](/Vulnerable%20Code%20Examples/php/xss.php)|
|[LFI](/Vulnerable%20Code%20Examples/php/lfi.php)|
|[SSRF](/Vulnerable%20Code%20Examples/php/ssrf.php)|
|[OS Command Injection](/Vulnerable%20Code%20Examples/php/commandInjection.php)|
|[SQL Injection - Boolean](/Vulnerable%20Code%20Examples/php/sqlinjection/boolen.php)|
|[SQL Injection - Error](/Vulnerable%20Code%20Examples/php/sqlinjection/error.php)|


## OSWE Like Machines
- https://www.vulnhub.com/entry/securecode-1,651/
- https://github.com/bmdyy

## Skeleton Scripts
Coming soon. . .

## Notes
Coming soon. . .

## Code Review Checklist
Coming soon. . .

## Regex
Tutorial: https://www.youtube.com/watch?v=rhzKDrUiJVk


